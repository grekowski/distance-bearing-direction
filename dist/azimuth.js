(function(c,d){"object"==typeof exports&&"undefined"!=typeof module?module.exports=d():"function"==typeof define&&define.amd?define(d):(c=c||self,c.azimuth=d())})(this,function(){var a=Number.prototype,t=Math.PI,u=Math.tan,v=Math.log,w=Math.abs,x=Math.atan2,y=Math.sin,z=Math.cos,A=Math.round,B=Math.sqrt;function C(b){return b*(i/180)}function k(b){return b*(180/i)}function l(f,a,b,c){if(f===b&&a===c)return 0;const d=C(f),e=C(b);let j=C(c-a);const l=g(h(i/4+e/2)/h(i/4+d/2));G(j)>i&&(0<j?j=-(2*i-j):j=2*i+j);const m=F(j,l),o=(k(m)+360)%360;return o}function m(e,a,b,c){if(e===b&&a===c)return 0;const f=C(e),g=C(b),h=C(c-a),i=d(h)*E(g),j=E(f)*d(g)-d(f)*E(g)*E(h),l=F(i,j),m=(k(l)+360)%360;return m}function n(c,a){if(isNaN(c)||isNaN(a))throw new Error("Parameter is not a number!");if(0>c||360<c)throw new Error("Parameter outside of range!");if(1>a||3<a)throw new Error("Parameter outside of range!");const b=["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"];let d=4;2==a&&(d=8),3==a&&(d=16);const i=360/d,f=b.length/d;let g=r(c/i)*f;return g>=b.length&&(g=0),b[g]}function o(c,e,f,g){if(c===f&&e===g)return 0;const h=C(c),i=C(f),j=C(c-f),k=C(e-g),l=d(j/2)*d(j/2)+E(h)*E(i)*d(k/2)*d(k/2),m=2*F(D(l),D(1-l));return b*m}function p(d,a,c,e){if(d===c&&a===e)return 0;const f=C(d),j=C(c),k=C(d-c);let l=C(a-e);const m=g(h(i/4+j/2)/h(i/4+f/2)),n=1e-11<G(m)?k/m:E(f);G(l)>i&&(0<l?l=-(2*i-l):l=2*i+l);const p=D(k*k+n*n*l*l)*b;return p}function q(c,a="m"){if("m"===a)return c;switch(a){case"km":return .001*c;break;case"ft":return 3.28084*c;break;case"yd":return 1.0936*c;break;case"mi":return 621371e-9*c;break;case"nm":return 539957e-9*c;break;default:return c}}var D=B,r=A,E=z,d=y,F=x,G=w,g=v,h=u,i=t;const b=6371009;return a.round=function(c=0){const a=new Number(this.valueOf());return+(r(a+"e+"+c)+"e-"+c)},function(g,a,{units:b="m",distancePrecision:c=0,formula:d="great-circle",azimuthPrecision:e=0,directionPrecision:f=2}={}){if("undefined"==typeof g||"undefined"==typeof a)throw new Error("At least one point is missing!");if([g,a].forEach(b=>{if(!b.hasOwnProperty("lat")||!b.hasOwnProperty("lng"))throw new Error("Latitude/Longitude property missing!");if(isNaN(b.lat)||isNaN(b.lng))throw new Error("Latitude/Longitude property must be a number!");if(180<G(b.lat)||90<G(b.lng))throw new Error("Latitude/Longitude property exceeding maximal value!")}),!["m","km","ft","yd","mi","nm"].includes(b))throw new Error("Units parameter type not supported!");if(isNaN(c)||isNaN(e)||15<c||15<e)throw new Error("Precision parameter is not a number or exceeds it's maximum value of 15!");if(!["great-circle","rhumb-line"].includes(d))throw new Error("Calculation formula type parameter not supported!");if(![0,1,2,3,"0","1","2","3"].includes(f))throw new Error("Compass precision parameter not supported!");let h={};const i=q("rhumb-line"===d?p(g.lat,g.lng,a.lat,a.lng):o(g.lat,g.lng,a.lat,a.lng),b).round(c);h.distance=i,h.units=b;const j=0===i?"":("rhumb-line"===d?l(g.lat,g.lng,a.lat,a.lng):m(g.lat,g.lng,a.lat,a.lng)).round(e);return h.azimuth=j,h.formula=d,0!=f&&(h.direction=0===i?"":n(j,f)),h}});